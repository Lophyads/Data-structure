经莫反后，问题转化为这样：

求满足下述条件的序列个数：
$$
\forall 1\leq i\leq n,[0\leq a_i\leq w_i][\sum_ia_i \leq S]
$$
考虑生成函数
$$
\prod_i(1+x+x^2+...+x^{w_i})
$$
变形：
$$
\prod_i\frac{(1-x^{w_i+1})}{1-x}=(1+x+...+x^\infty)^n\prod_i(1-x^{w_i+1})
$$
我们要求它的前 $S$ 项系数和。

注意，莫反之后会得到 $m$ 个这样的问题，但 $\sum S = O(m\log m)$

注意左边可以预处理，它的 $x^k$ 次项系数可以用隔板法得到，也即 $C(k+n-1,n-1)$

所以我们只需要得到右面的前 $S$ 项系数，然后跟左面对应相乘。

右面的显然是一个 01背包，可以 $O(nS)$ 计算

总时间复杂度 $O(nm\log m)$

